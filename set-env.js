const { writeFile } = require('fs');
const writeFileUsingFS = (targetPath, environmentFileContent) => {
  writeFile(targetPath, environmentFileContent, (err) => {
    if (err) {
      console.log(err);
    }
    if (environmentFileContent !== '') {
      console.log(`wrote variables to ${targetPath}`);
    }
  });
};
const firebase = JSON.parse(Buffer.from(process.argv[2], 'base64').toString('ascii'));
const AGORA_KEY = process.argv[3];
const target = './apps/angular-slack/src/environments/environment.prod.ts';
const environmentFileContent = `
  // This file was autogenerated by dynamically running ${process.argv[1]}
  export const environment = {
    production: ${true},
    host: 'https://api-slack-ng.herokuapp.com',
    firebase: {
      apiKey: '${firebase.apiKey}',
      authDomain: '${firebase.authDomain}',
      databaseURL: '${firebase.databaseURL}',
      projectId: '${firebase.projectId}',
      storageBucket: '${firebase.storageBucket}',
      messagingSenderId: '${firebase.messagingSenderId}',
      appId: '${firebase.appId}',
      measurementId: '${firebase.measurementId}',
    },
    webRtc: {
      AppID: '${AGORA_KEY}',
    },
  };
`;

writeFileUsingFS(target, environmentFileContent);
